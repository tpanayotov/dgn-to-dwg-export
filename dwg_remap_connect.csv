; MicroStation CONNECT Edition DGN to DWG Remap File
; For use with Export > DWG/DXF workflow
; Addresses all known translation issues

;==============================================================================
; FONT MAPPING TABLE
; Fixes: Illegible text, varying font heights, faded text, fraction display
;==============================================================================
BEGIN FONT_MAP
;DGN_Font_Name,DWG_Font_File,BigFont_File
STANDARD,txt.shx,
ENGINEERING,simplex.shx,
WORKING,simplex.shx,
FANCY,romanc.shx,
ROMAN,romans.shx,
ROMAN SIMPLEX,romans.shx,
ROMAN DUPLEX,romand.shx,
ROMAN COMPLEX,romanc.shx,
ROMAN TRIPLEX,romant.shx,
ITALIC,italicc.shx,
ITALIC COMPLEX,italicc.shx,
SCRIPT,scripts.shx,
SCRIPT SIMPLEX,scripts.shx,
SCRIPT COMPLEX,scriptc.shx,
GREEK,greeks.shx,
GREEK SIMPLEX,greeks.shx,
GREEK COMPLEX,greekc.shx,
GOTHIC GERMAN,gothicg.shx,
GOTHIC ENGLISH,gothice.shx,
GOTHIC ITALIAN,gothici.shx,
CYRILLIC,symap.shx,
CYRILLIC T,symap.shx,
ISO,isocp.shx,
ISO EQUAL,isocpeur.shx,
ISOCPEUR,isocpeur.shx,
ISOCP,isocp.shx,
ISOCT,isoct.shx,
ISOCT2,isoct2.shx,
ISOCT3,isoct3.shx,
ARCHITECTURAL,stylus.shx,
BLOCK,monotxt.shx,
MONOTXT,monotxt.shx,
MICRO,simplex.shx,
SYMAP,simplex.shx,
SYMPHONIE,simplex.shx,
ENGINEERING BUILT,simplex.shx,
BORDER,simplex.shx,
INTL_ENGINEERING,simplex.shx,
INTL_ISO,isocp.shx,
ARIAL,arial.ttf,
ARIAL NARROW,arialn.ttf,
ARIAL BLACK,ariblk.ttf,
TIMES NEW ROMAN,times.ttf,
COURIER NEW,cour.ttf,
TAHOMA,tahoma.ttf,
VERDANA,verdana.ttf,
*,txt.shx,
END FONT_MAP

;==============================================================================
; LINE STYLE MAPPING TABLE
; Fixes: Dashed lines to solid, centerlines missing, line pattern changes
;==============================================================================
BEGIN LINESTYLE_MAP
;DGN_LineStyle_Name,DWG_LineType_Name,Scale_Factor
0,CONTINUOUS,1.0
1,DASHED,1.0
2,HIDDEN,1.0
3,CENTER,1.0
4,PHANTOM,1.0
5,DOT,1.0
6,DASHDOT,1.0
7,BORDER,1.0
CONTINUOUS,CONTINUOUS,1.0
DASHED,DASHED,1.0
DASHED2,DASHED2,1.0
DASHEDX2,DASHEDX2,1.0
HIDDEN,HIDDEN,1.0
HIDDEN2,HIDDEN2,1.0
HIDDENX2,HIDDENX2,1.0
CENTER,CENTER,1.0
CENTER2,CENTER2,1.0
CENTERX2,CENTERX2,1.0
PHANTOM,PHANTOM,1.0
PHANTOM2,PHANTOM2,1.0
PHANTOMX2,PHANTOMX2,1.0
DOT,DOT,1.0
DOT2,DOT2,1.0
DOTX2,DOTX2,1.0
DASHDOT,DASHDOT,1.0
DASHDOT2,DASHDOT2,1.0
DASHDOTX2,DASHDOTX2,1.0
DIVIDE,DIVIDE,1.0
DIVIDE2,DIVIDE2,1.0
DIVIDEX2,DIVIDEX2,1.0
BORDER,BORDER,1.0
BORDER2,BORDER2,1.0
BORDERX2,BORDERX2,1.0
ACAD_ISO02W100,ACAD_ISO02W100,1.0
ACAD_ISO03W100,ACAD_ISO03W100,1.0
ACAD_ISO04W100,ACAD_ISO04W100,1.0
ACAD_ISO05W100,ACAD_ISO05W100,1.0
ACAD_ISO06W100,ACAD_ISO06W100,1.0
ACAD_ISO07W100,ACAD_ISO07W100,1.0
ACAD_ISO08W100,ACAD_ISO08W100,1.0
ACAD_ISO09W100,ACAD_ISO09W100,1.0
ACAD_ISO10W100,ACAD_ISO10W100,1.0
ACAD_ISO11W100,ACAD_ISO11W100,1.0
ACAD_ISO12W100,ACAD_ISO12W100,1.0
ACAD_ISO13W100,ACAD_ISO13W100,1.0
ACAD_ISO14W100,ACAD_ISO14W100,1.0
ACAD_ISO15W100,ACAD_ISO15W100,1.0
GAS_LINE,GAS_LINE,1.0
HOT_WATER_SUPPLY,HOT_WATER_SUPPLY,1.0
BATTING,BATTING,1.0
FENCELINE1,FENCELINE1,1.0
FENCELINE2,FENCELINE2,1.0
TRACKS,TRACKS,1.0
ZIGZAG,ZIGZAG,1.0
*,CONTINUOUS,1.0
END LINESTYLE_MAP

;==============================================================================
; COLOR MAPPING TABLE
; Fixes: Color changes, grey/red text instead of black, faded elements
;==============================================================================
BEGIN COLOR_MAP
;DGN_Color_Index,DWG_ACI_Color
0,7
1,1
2,2
3,3
4,4
5,5
6,6
7,7
8,8
9,9
10,10
11,11
12,12
13,13
14,14
15,15
16,16
17,17
18,18
19,19
20,20
21,21
22,22
23,23
24,24
25,25
26,26
27,27
28,28
29,29
30,30
31,31
32,32
33,33
34,34
35,35
36,36
37,37
38,38
39,39
40,40
41,41
42,42
43,43
44,44
45,45
46,46
47,47
48,48
49,49
50,50
51,51
52,52
53,53
54,54
55,55
56,56
57,57
58,58
59,59
60,60
61,61
62,62
63,63
64,64
65,65
66,66
67,67
68,68
69,69
70,70
254,7
255,7
END COLOR_MAP

;==============================================================================
; LINE WEIGHT MAPPING TABLE
; Fixes: Line visibility, faded appearance, weight inconsistencies
;==============================================================================
BEGIN WEIGHT_MAP
;DGN_Weight,DWG_Lineweight_mm
0,0.00
1,0.05
2,0.09
3,0.13
4,0.15
5,0.18
6,0.20
7,0.25
8,0.30
9,0.35
10,0.40
11,0.50
12,0.53
13,0.60
14,0.70
15,0.80
16,0.90
17,1.00
18,1.06
19,1.20
20,1.40
21,1.58
22,2.00
23,2.11
24,2.50
25,3.00
26,3.50
27,4.00
28,4.50
29,5.00
30,5.50
31,6.00
END WEIGHT_MAP

;==============================================================================
; LEVEL TO LAYER MAPPING
; Fixes: Missing elements, equipment, concrete, design features
;==============================================================================
BEGIN LEVEL_MAP
;DGN_Level_Name,DWG_Layer_Name,Color,LineType,Frozen,Locked
*,*,BYLAYER,BYLAYER,N,N
END LEVEL_MAP

;==============================================================================
; TEXT STYLE MAPPING
; Fixes: Text overlap, title block issues, font variations
;==============================================================================
BEGIN TEXTSTYLE_MAP
;DGN_TextStyle,DWG_TextStyle,Font,Height,WidthFactor
STANDARD,STANDARD,txt.shx,0.0,1.0
NOTES,STANDARD,simplex.shx,0.0,1.0
TITLE,STANDARD,simplex.shx,0.0,1.0
LABEL,STANDARD,simplex.shx,0.0,1.0
DIMENSIONS,STANDARD,simplex.shx,0.0,1.0
ANNOTATION,STANDARD,simplex.shx,0.0,1.0
GENERAL,STANDARD,txt.shx,0.0,1.0
*,STANDARD,txt.shx,0.0,1.0
END TEXTSTYLE_MAP

;==============================================================================
; DIMENSION STYLE MAPPING
; Fixes: Fractions not showing, dimension overlap, scale issues
;==============================================================================
BEGIN DIMSTYLE_MAP
;DGN_DimStyle,DWG_DimStyle
STANDARD,STANDARD
MECHANICAL,STANDARD
ARCHITECTURAL,STANDARD
CIVIL,STANDARD
STRUCTURAL,STANDARD
PIPING,STANDARD
ELECTRICAL,STANDARD
*,STANDARD
END DIMSTYLE_MAP

;==============================================================================
; CELL/BLOCK MAPPING
; Fixes: Valve states, symbol issues, missing equipment
;==============================================================================
BEGIN CELL_MAP
;DGN_Cell_Name,DWG_Block_Name,Scale,Rotation
*,*,1.0,0.0
END CELL_MAP

;==============================================================================
; HATCH PATTERN MAPPING
; Fixes: Shading issues, fill pattern problems
;==============================================================================
BEGIN HATCH_MAP
;DGN_Pattern,DWG_Pattern,Scale,Angle
SOLID,SOLID,1.0,0.0
ANSI31,ANSI31,1.0,0.0
ANSI32,ANSI32,1.0,0.0
ANSI33,ANSI33,1.0,0.0
ANSI34,ANSI34,1.0,0.0
ANSI35,ANSI35,1.0,0.0
ANSI36,ANSI36,1.0,0.0
ANSI37,ANSI37,1.0,0.0
ANSI38,ANSI38,1.0,0.0
BRICK,BRICK,1.0,0.0
CONCRETE,CONCRETE,1.0,0.0
CROSS,CROSS,1.0,0.0
EARTH,EARTH,1.0,0.0
GRASS,GRASS,1.0,0.0
GRAVEL,GRAVEL,1.0,0.0
*,SOLID,1.0,0.0
END HATCH_MAP

;==============================================================================
; EXPORT SETTINGS
; Fixes: Scaling, cloud alignment, text boundaries, reference issues
;==============================================================================
BEGIN SETTINGS
;Setting,Value,Description
EXPORT_VERSION,2018,AutoCAD version for compatibility
UNIT_MASTER,FEET,Master unit setting
UNIT_SUB,INCHES,Sub unit setting
DWG_UNIT,INCHES,Target DWG unit
GLOBAL_SCALE_FACTOR,1.0,Overall scale multiplier
LINETYPE_SCALE,1.0,Line type scale factor
TEXT_SCALE,1.0,Text scale factor
DIMENSION_SCALE,1.0,Dimension scale factor
EXPORT_ALL_LEVELS,YES,Include all levels
EXPORT_REFERENCES,YES,Include reference attachments
FLATTEN_REFERENCES,NO,Flatten nested references
PRESERVE_TEXT_NODES,YES,Maintain text boundaries
PRESERVE_DIMENSION_ASSOC,YES,Keep dimension associations
PRESERVE_REVISION_CLOUDS,YES,Maintain cloud positions
CONVERT_FRACTIONS,STACKED,Convert fractions to stacked
MAINTAIN_LEADER_ARROWS,YES,Preserve arrows on leaders
COORDINATE_PRECISION,8,Decimal precision for coords
EXPORT_TITLE_BLOCKS,AS_BLOCK,Export title block as block
PRESERVE_CELL_ORIGINS,YES,Maintain cell insertion points
PRESERVE_DRAW_ORDER,YES,Maintain element stacking
END SETTINGS
